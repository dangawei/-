<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>中富股份--后台管理</title>
    <script src="/js/jquery.min.js"></script>
    <link rel='stylesheet' href='/css/reset-min.css'/>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
</head>
<body ng-app="myApp">

<nav class="navbar navbar-default">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">后台管理</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="#" data-target="#carousel-example-generic" data-slide-to="0">首页</a></li>
                <li><a href="#" data-target="#carousel-example-generic" data-slide-to="1">新闻动态</a></li>
                <li><a href="#" data-target="#carousel-example-generic" data-slide-to="2">产品信息</a></li>
                <li><a href="#" data-target="#carousel-example-generic" data-slide-to="3">招聘信息</a></li>
                <li><a href="#" data-target="#carousel-example-generic" data-slide-to="4">投简信息</a></li>
                <li><a href="#" data-target="#carousel-example-generic" data-slide-to="5">订单信息</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                       aria-expanded="false">操作<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#">注销</a></li>
                    </ul>
                </li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>
<section ng-controller="myCtrl">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div id="carousel-example-generic" class="carousel slide" data-interval="0" data-ride="carousel">
                    <div class="carousel-inner" role="listbox">
                        <div class="item active">
                            <div class="jumbotron">
                                <h1>中富股份-后台管理 <span style="font-size: 18px;">1.0</span></h1>
                                <p>在这里您可以进行如下操作:</p>
                                <p>1.管理新闻动态</p>
                                <p>2.管理产品信息</p>
                                <p>3.管理招聘信息</p>
                                <p>4.查看简历信息</p>
                                <p>5.产看订单/留言信息</p>
                            </div>
                        </div>
                        <div class="item">
                            <table class="table text-center table-hover table-responsive">
                                <tr>
                                    <th>标题</th>
                                    <th>时间</th>
                                    <th>内容</th>
                                    <th>图片路径</th>
                                    <th>操作</th>
                                </tr>
                                <tr ng-repeat="new in news" ng-click="showNewForm(new)">
                                    <td>\{{new.title}}</td>
                                    <td>\{{new.news_date}}</td>
                                    <td>\{{new.content}}</td>
                                    <td>\{{new.img}}</td>
                                    <td>
                                        <button class="btn btn-default" ng-click="delNew(new)">删除</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5">
                                        <button ng-click="showNewAddForm()" class="btn btn-default">添加新闻</button>
                                    </td>
                                </tr>
                            </table>
                            <form class="form-horizontal" ng-submit="commitNew(new)" ng-show="isNewShow">
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-2 control-label">标题:</label>
                                    <div class="col-sm-4">
                                        <textarea class="form-control" cols="30" rows="5"
                                                  ng-model="new.title"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="" class="col-sm-2 control-label">时间:</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" ng-model="new.news_date">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="" class="col-sm-2 control-label">内容:</label>
                                    <div class="col-sm-4">
                                        <textarea class="form-control" cols="30" rows="10"
                                                  ng-model="new.content"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="" class="col-sm-2 control-label">路径:</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" ng-model="new.img">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-offset-2 col-sm-4">
                                        <button type="submit" class="btn btn-default">更新</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="item">
                            <table class="table table-hover">
                                <tr>
                                    <th>名字</th>
                                    <th>图片路径</th>
                                </tr>
                                <tr ng-repeat="pd in products">
                                    <td>\{{pd.name}}</td>
                                    <td>\{{pd.img_url}}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="item">
                            <table class="table table-hover">
                                <tr>
                                    <th>职位</th>
                                    <th>薪资待遇</th>
                                    <th>招聘人数</th>
                                    <th>结束时间</th>
                                    <th>招聘概要</th>
                                </tr>
                            </table>
                        </div>
                        <div class="item">
                            <table class="table table-hover">
                                <tr>
                                    <th>职位</th>
                                    <th>姓名</th>
                                    <th>性别</th>
                                    <th>电话</th>
                                    <th>地址</th>
                                    <th>邮箱</th>
                                    <th>备注</th>
                                </tr>
                            </table>
                        </div>
                        <div class="item">
                            <table class="table table-hover">
                                <tr>
                                    <th>姓名</th>
                                    <th>电话</th>
                                    <th>地址</th>
                                    <th>邮箱</th>
                                    <th>备注</th>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script src="js/bootstrap.min.js"></script>
<script src="js/angular.min.js"></script>
<script>
    var app = angular.module('myApp', []);
    app.controller('myCtrl', function ($scope, $http) {
        $scope.isNewShow = false;
        $scope.isAdd = false;
        getDatas();
        function getDatas() {
            $http.get('/ht_news').then(function (res) {
                $scope.news = res.data.results;
            });
            $http.get('/ht_products').then(function (res) {
                $scope.products = res.data.results;
            });
        }

        $scope.showNewForm = function (obj) {
            $scope.isNewShow = !$scope.isNewShow;
            $scope.isAdd = false;
            $scope.new = obj;
        }
        $scope.showNewAddForm = function () {
            $scope.isNewShow = !$scope.isNewShow;
            $scope.isAdd = true;
            $scope.newAdd = {};
        }
        $scope.commitNew = function (obj) {
            if ($scope.isAdd) {
                $scope.newAdd = obj;
                $scope.isNewShow = !$scope.isNewShow;
                $http.post('/add_new', $scope.newAdd).then(function (res) {
                    if (res.success) {
                        $scope.news.push(obj);
                    }
                });
            } else {
                $scope.new = obj;
                $scope.isNewShow = !$scope.isNewShow;
                $http.put('/cmt_new', $scope.new);
            }

        }
        $scope.delNew = function (obj) {
            if (confirm('确定删除么?')) {
                $http.delete('/del_new/' + obj.id).then(function (res) {
                    if (res.success) {
                        $scope.news.splice($scope.news.indexOf(obj), 1);
                        alert('删除成功！');
                    }
                });
            }
        }
    });
</script>
</body>
</html>